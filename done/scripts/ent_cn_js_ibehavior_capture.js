$(document).bind('click', function (event) {
    if (event.target.tagName == 'A') {

        var sourceElement = event.target;
        var target = $(event.target).attr("target");
        var href = $(event.target).attr("href");
        //do not capture a link onclick attribute value==onclick or baidu share a markup
        if (sourceElement.getAttribute("onclick") == "return false;" || $(event.target).parents(".bdshare_popup_box").length
             || (href && (href.indexOf("#") == 0 || href.indexOf("javascript") == 0)))
            return;

  		if ((!target || target == "_self") && sourceElement.href != "" && sourceElement.href.indexOf("#") != 0) {
                setTimeout(function() {
                  window.location.href = sourceElement.href;
                }, 500);
                event.preventDefault();
		}
	}

});

(function($, undefined){
$(function($){
//bof

if($("#Breadcrumb-Trail").length==0) return;
var mtdt_list=[];
var mtdt;
$("#Breadcrumb-Trail").find("input").each(function(i, o){
mtdt_list.push($(this).val());
});
var mtdt_length=mtdt_list.length
if(mtdt_length<7){
	for(var i=0;i<7-mtdt_length;i++)mtdt_list.push("");
}
mtdt=mtdt_list.join("/");

$("#V_mtdt").val(mtdt);

//eof
});
})(jQuery);

var iBDom = {};
iBDom.query = window.jQuery;//jQuery.noConflict(true);

//
//  ibehavior.js
//  <iBehavior
//
//  Created by l00175152 on 2011-11-08.
//  Copyright 2011 l00175152. All rights reserved.
//
(function($) {
	//setCookies();
	//ajaxState:???????????????ajax????????????????????????????????????
	//        none:      ?????????ajax
	//        loading???     ????????????
	//        completed???????????????
	var ajaxState = "none";
	//DOM?????????????????????document???????????????ajax?????????????????????????????????ajax?????????????????????????????????DomReady?????????????????????ajax????????????????????????????????????traceDomReady?????????????????????ajax??????????????????
	//?????????ajax?????????????????????????????????????????????????????????ajax??????????????????????????????????????????,???????????????????????????ajax???
	//DomReady??????????????????????????????????????????????????????ajaxStop?????????traceDomReady()????????????????????????????????????traceDomReady()
	$(document).ajaxStart(function() {
		ajaxState = "loading";
	});
	$(document).ajaxStop(function() {
		ajaxState = "completed";
	});
	var $iBehaviorClick = new Object(), $iBehaviorDomReady = new Object();
	//???????????????2????????????????????????a??????????????????????????????????????????????????????????????????????????????
	//???????????????????????????????????????????????????
	$(document).ready(function() {
		if($("#iBehaviorTrace").length != 0) {
			//???iBehaviorClick????????????????????????
			if($("#iBehaviorClick").length > 0) {
				//????????????ajax????????????????????????????????????????????????????????????????????????????????????????????????????????????
				$(document).ajaxStop(traceClick);
				//setTimeout(function(){traceClick()},2000);
				traceClick();
			}
		}
	});
	$(document).ready(function() {
		setCookies();
		//???????????????cookie????????????????????????
			if($("#V_ckid").size()>0){
				var v1st = GetCookie("v1st");
				if(v1st != null){
				  $("#V_ckid").val(v1st);
				}
			}
		//???????????????userid????????????????????????
		if($("#V_userName").size()>0){
			c_start=document.cookie.indexOf("ssc");
			 if (c_start!=-1){
			 	c_start=c_start + 4; 
			 	c_end=document.cookie.indexOf(":",c_start);
			 	if(c_end!=-1){
			 		c_userid = document.cookie.substring(c_start,c_end);
			 		$("#V_userName").val(c_userid);
			 	}else{
			 		$("#V_userName").val("anonymous");
			 	}
			 	
			 }else{
			 	$("#V_userName").val("anonymous");
			 }
		}
		$("#V_native").val(window.location.href);
		if($("#iBehaviorTrace").length != 0) {
			//???iBehaviorDomReady????????????????????????
			if($("#iBehaviorDomReady").length > 0) {
				if(ajaxState == "loading") {
					$(document).ajaxStop(traceDomReady);
				} else {
					traceDomReady();
				}
			}
		}
	});
	/*=======================================================
	 ????????????,??????????????????,????????????
	 */
	function traceClick() {
		$iBehaviorClick = $("#iBehaviorClick");
		bindVariableTags();
	}

	/*=======================================================
	 ?????????????????????????????????DomReady???????????????????????????
	 */
	function traceDomReady() {
		$iBehaviorDomReady = $("#iBehaviorDomReady");
		var constantUrlDomReady = "";
		//???????????????????????????????????????
		constantUrlDomReady = getConstantUrl($iBehaviorDomReady);
		//???????????????????????????
		traceBehaviorDomHandler(constantUrlDomReady);

	}

	/*=======================================================
	 ??????????????????????????????????????????????????????url
	 */
	function getConstantUrl($iBehaviorTrace) {
		var constantUrlPre = "";
		$iBehaviorTrace.find("#iBehaviorConstant").children().each(function() {
			var $thisSpan = $(this);
			constantUrlPre = constantUrlPre + "&" + $thisSpan.attr("wadimension") + "=" + encodeURIComponent($thisSpan.attr("wacontent"));
		});
		return constantUrlPre;
	}

	/*=======================================================
	 ?????????????????????????????????????????????????????????url????????????
	 */
	function getVariableUrl(event, $currentClick) {
		var ibResult = "";
		var ibTargetKey = event.data.key;
		var $ibTargetObject = $("#iBehaviorVariable").find("[waselector='" + ibTargetKey + "']");
		//?????????????????????
		if($ibTargetObject.length == 1) {
			//???????????????
			var dimensionName = event.data.dimension;
			//?????????????????????
			var attrName = event.data.attrName;
			//??????????????????
			var attr = "";
			if(attrName == "text") {
				attr = encodeURIComponent($.trim($currentClick.text()));
			} else {
				attr = encodeURIComponent($.trim($currentClick.attr(attrName)));
			}
			//??????url
			ibResult = dimensionName + "=" + attr;
			var ibehaviorUrl = "&" + ibResult;
		} else if($ibTargetObject.length > 1) {
			$ibTargetObject.each(function() {
				//???????????????
				var dimensionName = $(this).attr("wadimension");
				//?????????????????????
				var attrName = $(this).attr("targetattr");
				//??????????????????
				var attr = "";
				if(attrName == "text") {
					attr = encodeURIComponent($.trim($currentClick.text()));
				} else {
					attr = encodeURIComponent($.trim($currentClick.attr(attrName)));
				}
				//??????url
				ibResult = ibResult + "&" + dimensionName + "=" + attr;
			});
			var ibehaviorUrl = "&" + ibResult;
		}
		return ibehaviorUrl;
	}

	/*=======================================================
	 ??????????????? ???????????????????????????????????????url????????????????????????????????????????????????
	 */
	function getUserDefinedUrl($iBehaviorTrace) {
		var userDefinedUrlPre = "";
		var attrValue = "";
		$iBehaviorTrace.find("#iBehaviorUserDefined").children().each(function() {
			var $spanDefined = $(this);
			var targetKeyDefined = $spanDefined.attr("waselector");
			var dimensionalNameDefined = $spanDefined.attr("wadimension");
			var targetAttrDefined = $spanDefined.attr("targetattr");
			if(targetAttrDefined == "text") {
				attrValue = $(targetKeyDefined).text();
			} else {
				attrValue = $(targetKeyDefined).attr(targetAttrDefined);
			}
			userDefinedUrlPre = userDefinedUrlPre + "&" + dimensionalNameDefined + "=" + encodeURIComponent(attrValue);
		});
		return userDefinedUrlPre;
	}

	/*=======================================================
	 ?????????????????????????????????????????????????????????????????????url
	 */
	function getConstantUrlOnClick(event, $iBehaviorTrace) {
		var constantUrlPre = "";
		$iBehaviorTrace.find("#iBehaviorConstant").children().each(function() {
			var $thisConSpan = $(this);
			var paramCounter = 0;
			for(withDimension in event.data.clickParams) {
				if(event.data.clickParams[paramCounter].withDimension == $thisConSpan.attr("wadimension")) {
					constantUrlPre = constantUrlPre + "&" + $thisConSpan.attr("wadimension") + "=" + encodeURIComponent($thisConSpan.attr("wacontent"));
				}
				paramCounter = paramCounter + 1;
			}
		});
		return constantUrlPre;
	}

	/*=======================================================
	 ?????????????????????????????????????????????????????????????????????????????????url
	 */
	function getUserDefinedUrlOnClick(event, $iBehaviorTrace) {
		var userDefinedUrlPre = "";
		var attrValue = "";
		$iBehaviorTrace.find("#iBehaviorUserDefined").children().each(function() {
			var $spanDefined = $(this);
			var paramCounter = 0;
			for(withDimension in event.data.clickParams) {
				if(event.data.clickParams[paramCounter].withDimension == $spanDefined.attr("wadimension")) {
					var targetKeyDefined = $spanDefined.attr("waselector");
					var dimensionalNameDefined = $spanDefined.attr("wadimension");
					var targetAttrDefined = $spanDefined.attr("targetattr");
					if(targetAttrDefined == "text") {
						attrValue = $(targetKeyDefined).text();
					} else {
						attrValue = $(targetKeyDefined).attr(targetAttrDefined);
					}
					userDefinedUrlPre = userDefinedUrlPre + "&" + dimensionalNameDefined + "=" + encodeURIComponent($.trim(attrValue));
				}
				paramCounter = paramCounter + 1;
			}
		});
		return userDefinedUrlPre;
	}

	/*=======================================================
	 ????????????????????????????????????click??????
	 */
	function bindVariableTags() {
		//?????????????????????????????????
		var params = parseMeta();
		//????????????????????????click??????
		var paramCount = 0;
		for(key in params) {
			//???????????????????????????????????????????????????????????????
			$(document).undelegate(params[paramCount].key, "click", traceBehaviorHandler);
			$(document).delegate(params[paramCount].key, "click", params[paramCount], traceBehaviorHandler);
			paramCount++;
		}
	}

	/*=======================================================
	 ????????????????????????????????????????????????span???????????????????????????????????????
	 */
	function parseMeta() {
		var ibParams = {};

		var paramCounter = 0;
		$iBehaviorClick.find("#iBehaviorVariable").children().each(function() {
			var $span = $(this);
			var withParamCounter = 0;
			var withParams = {};
			$span.children().each(function() {
				var $withSpan = $(this);
				withParams[withParamCounter] = {
					withDimension : $withSpan.attr("wadimension")
				}
				withParamCounter = withParamCounter + 1;
			});
			var targetKey = $span.attr("waselector");
			var dimensionalName = $span.attr("wadimension");
			var targetAttr = $span.attr("targetattr");
			ibParams[paramCounter] = {
				key : targetKey,
				dimension : dimensionalName,
				attrName : targetAttr,
				clickParams : withParams
			};
			paramCounter = paramCounter + 1;
		});
		return ibParams;
	}

	/*=========================================================================
	 ??????????????????????????????????????????
	 */
	function traceBehaviorHandler(event) {
		var $currentClickTag = $(this);
		//var $iBehaviorClick = $("#iBehaviorClick");
		var constantsUrl = getConstantUrlOnClick(event, $iBehaviorClick);
		var variableUrl = getVariableUrl(event, $currentClickTag);
		var userDefinedUrl = getUserDefinedUrlOnClick(event, $iBehaviorClick);
		var lastURL = constantsUrl + variableUrl + userDefinedUrl;
		//alert(lastURL);
		sendData(lastURL);
	}

	/*=========================================================================
	 ????????????????????????????????????????????????????????????????????????
	 */
	function traceBehaviorDomHandler(constantUrlDom) {
		var userDefinedUrl = getUserDefinedUrl($iBehaviorDomReady);
		var lastURL = constantUrlDom + userDefinedUrl;
		//alert(lastURL);
		sendData(lastURL);
	}

	//======================================================================
	//??????????????????sensor????????????????????????????????????
	function sendData(iBehaviorUrl) {
		var iBehavior = iBehaviorObj();
		iBehavior.v = {};
		iBehavior.v["result"] = iBehaviorUrl;
		iBehavior.send();
	}

	/*======================================================================
	 ?????????????????????????????????DOM??????????????????
	 */
	function iBehaviorObj() {
		var oTempIBehavior = new Object();
		oTempIBehavior.ct = "<img style='display:none' src=";
		oTempIBehavior.cd = iBehaviorCommonURL + "/ws/ibehavior";
		oTempIBehavior.cu = "/transmit/sensor?Log=1";
		oTempIBehavior.ce = ">";
		oTempIBehavior.d = {};
		oTempIBehavior.d["dt"] = document.title;
		oTempIBehavior.d["dr"] = document.referrer;
		oTempIBehavior.d["cb"] = new Date().getTime();
		oTempIBehavior.vo = "";
		oTempIBehavior.send = function() {
			if( typeof oTempIBehavior.v != "undefined") {
				for(vKey in oTempIBehavior.v ) {
					oTempIBehavior.vo = oTempIBehavior.v[vKey];
				}
			}
			for(dKey in oTempIBehavior.d ) {
				oTempIBehavior.vo = oTempIBehavior.vo + "&" + dKey + "=" + encodeURIComponent(oTempIBehavior.d[dKey]);
			}
			//var ib_script = document.createElement("script");
			//ib_script.type = "text/javascript";
			//ib_script.src = this.cd + this.cu + this.vo;
			var image = new Image(1, 1);

      		image.onload = function() {};
      		$.trim(this.cd + this.cu + this.vo);
      		var ibehaviorUrl = this.cd + this.cu + this.vo;
      		var reStr = /%09|%0A/gi;
      		var newIbehaviorUrl = ibehaviorUrl.replace(reStr,'')
      		
      		image.src =  newIbehaviorUrl;
   
			setCookies();
			
		}
		return oTempIBehavior;
	}

	function setCookies() {
		var x_trackingId = "v1st=";
		var c_start = document.cookie.indexOf(x_trackingId);
		//????????????v1st???????????????????????????visitor????????????sensor??????????????????????????????????????????
		if(c_start == -1) {
			var x_trackingIdValue = getUniCode();
			document.cookie = x_trackingId + escape(x_trackingIdValue) + "; expires=" + "Wed, 19 Feb 2020 14:28:00 GMT; domain=huawei.com; path=/;";
		}
		
	}

	//?????????????????????????????????16????????????????????????1???2???????????????????????????????????????????????????16-???????????????length?????????????????????????????????16????????????????????????????????????
	//?????????????????????????????????16??????????????????????????????????????????????????????16????????????????????????16????????????uniqid???
	function getUniCode() {
		var uniCode = new Date().getTime().toString(16);
		uniCode += Math.floor((1 + Math.random()) * Math.pow(16, (16 - uniCode.length))).toString(16).substr(1);
		return uniCode.toLocaleUpperCase();
	}
	//return the trace api
	window.traceBehavior = function (e) {
	    try {
	        if (typeof e == "function") {
	            e(parseMeta, traceBehaviorHandler);
	            return;
	        }
	        if (typeof e == "object") {
	            var index = arguments[1] || 1;
	            if (typeof index == "number") {
	                e.data = parseMeta()[index];
	            } else if (typeof index == "string") {
	                $.each(parseMeta(), function (i, o) {
	                    if (o.key == index)
	                        e.data = o;
	                });
	            }

	            traceBehaviorHandler.call(e.target, e);
	            //	traceBehaviorHandler.apply(this,arguments);
	        }
	    } catch (_e) {}
	};

})(iBDom.query);
//??????cookie???v1st??????
function GetCookie(sName)
{
 var aCookie = document.cookie.split("; ");
	for (var i = 0; i < aCookie.length; i++)
	{
		var aCrumb = aCookie[i].split("=");
		if (sName == aCrumb[0])
		return aCrumb[1];
	}
return null;
}
